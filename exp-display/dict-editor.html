<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TTS Dict Editor</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; margin:16px; background:#0b1020; color:#e5e7eb;}
    h1{font-size:18px; margin:0 0 12px;}
    .row{display:flex; gap:8px; flex-wrap:wrap; align-items:center; margin:8px 0;}
    button{background:#111827; color:#e5e7eb; border:1px solid #374151; padding:8px 10px; border-radius:10px; cursor:pointer;}
    button:hover{border-color:#6b7280;}
    input,select,textarea{background:#0f172a; color:#e5e7eb; border:1px solid #374151; border-radius:10px; padding:8px; }
    table{width:100%; border-collapse:collapse; margin-top:12px;}
    th,td{border-bottom:1px solid #243048; padding:8px; vertical-align:top;}
    th{font-size:12px; color:#9ca3af; text-align:left;}
    .mini{font-size:12px; color:#9ca3af;}
    .danger{border-color:#ef4444;}
    .ok{color:#34d399;}
    .warn{color:#fbbf24;}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;}
  </style>
</head>
<body>

  <!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TTS Dict Editor</title>
  <style>
    :root{
      --bg:#0b1020;
      --panel:#0f172a;
      --panel2:#0b1226;
      --line:#243048;
      --line2:#374151;
      --text:#e5e7eb;
      --muted:#9ca3af;
      --ok:#34d399;
      --warn:#fbbf24;
      --danger:#ef4444;
      --shadow: 0 18px 50px rgba(0,0,0,.45);
    }
    body{
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
      margin:16px;
      background:var(--bg);
      color:var(--text);
    }
    h1{font-size:18px; margin:0 0 12px;}
    .mini{font-size:12px; color:var(--muted);}
    .ok{color:var(--ok);}
    .warn{color:var(--warn);}
    .danger{border-color:var(--danger)!important;}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;}

    button{
      background:#111827;
      color:var(--text);
      border:1px solid var(--line2);
      padding:8px 10px;
      border-radius:10px;
      cursor:pointer;
      white-space:nowrap;
    }
    button:hover{border-color:#6b7280;}
    input,select,textarea{
      background:var(--panel);
      color:var(--text);
      border:1px solid var(--line2);
      border-radius:10px;
      padding:8px;
    }

    /* ===== layout: left editor / right json ===== */
    .app{
      display:grid;
      grid-template-columns: 1.25fr .75fr;
      gap:12px;
      align-items:start;
    }
    @media (max-width: 980px){
      .app{ grid-template-columns: 1fr; }
    }
    .card{
      background: rgba(15,23,42,.55);
      border:1px solid rgba(255,255,255,.08);
      border-radius:16px;
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .cardHead{
      padding:12px;
      border-bottom:1px solid rgba(255,255,255,.08);
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      align-items:center;
    }
    .cardBody{ padding:12px; }

    /* sticky add form */
    .addBox{
      position: sticky;
      top: 12px;
      z-index: 5;
      background: rgba(11,16,32,.92);
      backdrop-filter: blur(8px);
      border:1px solid rgba(255,255,255,.10);
      border-radius:14px;
      padding:10px;
      margin-bottom:10px;
    }
    .addGrid{
      display:grid;
      grid-template-columns: 110px 1fr 110px 1fr 140px 120px;
      gap:8px;
      align-items:center;
    }
    @media (max-width: 980px){
      .addGrid{ grid-template-columns: 110px 1fr 110px 1fr; }
      .addGrid .span2{ grid-column: span 2; }
    }
    .addActions{
      display:flex;
      gap:8px;
      align-items:center;
      margin-top:8px;
      flex-wrap:wrap;
    }
    .badge{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      min-width: 20px;
      height: 20px;
      padding: 0 8px;
      border-radius: 999px;
      font-weight:900;
      font-size:12px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(2,6,23,.35);
      color: rgba(226,232,240,.95);
    }

    /* table / rows */
    .tableWrap{
      max-height: calc(100vh - 220px);
      overflow:auto;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.08);
      background: rgba(2,6,23,.22);
    }
    table{width:100%; border-collapse:collapse;}
    th,td{border-bottom:1px solid var(--line); padding:8px; vertical-align:top;}
    th{font-size:12px; color:var(--muted); text-align:left; position: sticky; top: 0; background: rgba(11,16,32,.96); z-index:2;}
    .ops{display:flex; gap:6px; align-items:center;}
    .handle{
      cursor: grab;
      user-select:none;
      padding:6px 8px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(2,6,23,.30);
    }
    tr.dragging{opacity:.4;}
    tr.dropTarget{outline:2px solid rgba(52,211,153,.55); outline-offset:-2px;}

    /* right json */
    .jsonArea{
      height: calc(100vh - 120px);
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    #jsonOut{
      width:100%;
      flex:1;
      resize:none;
    }
    .rightActions{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
    }
  </style>
</head>
<body>
  <h1>ğŸ—£ TTS è¾æ›¸ã‚¨ãƒ‡ã‚£ã‚¿ï¼ˆtts-dict.jsonï¼‰</h1>
  <div class="mini">å½¢å¼ï¼štext / word / regexï¼ˆregex ã¯ from ã‚’æ­£è¦è¡¨ç¾ã€flags ä¾‹: g, giï¼‰</div>

  <div class="app">

    <!-- ===== LEFT: editor ===== -->
    <div class="card">
      <div class="cardHead">
        <button id="loadBtn">ğŸ“¥ dict/tts-dict.json ã‚’èª­ã¿è¾¼ã‚€</button>
        <button id="validateBtn">âœ… æ¤œè¨¼</button>
        <button id="downloadBtn">â¬‡ï¸ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
        <span id="msg" class="mini"></span>
      </div>

      <div class="cardBody">

        <!-- sticky add form -->
        <div class="addBox">
          <div class="mini" style="margin-bottom:6px;">
            <span class="badge">è¿½åŠ </span> ã“ã“ã¯å¸¸ã«ä¸Šã«å›ºå®šï¼ˆã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ä¸è¦ï¼‰
          </div>

          <div class="addGrid">
            <select id="addType" title="type">
              <option value="text">text</option>
              <option value="word">word</option>
              <option value="regex">regex</option>
            </select>

            <input id="addFrom" placeholder="fromï¼ˆä¾‹ï¼šè¡€æµï¼‰" />

            <input id="addFlags" placeholder="flagsï¼ˆregexã®ã¿ï¼‰" value="g" />

            <input id="addTo" placeholder="toï¼ˆä¾‹ï¼šã‘ã¤ã‚Šã‚…ã†ï¼‰" />

            <select id="addPos" class="span2" title="æŒ¿å…¥ä½ç½®">
              <option value="top">ä¸Šï¼ˆå…ˆé ­ï¼‰</option>
              <option value="mid" selected>ä¸­ï¼ˆä¸­å¤®ï¼‰</option>
              <option value="bottom">ä¸‹ï¼ˆæœ«å°¾ï¼‰</option>
            </select>

            <button id="addDo" class="span2">â• è¿½åŠ ã™ã‚‹</button>
          </div>

          <div class="addActions mini">
            <span>ä¸¦ã¹æ›¿ãˆï¼šå„è¡Œã® <span class="badge">â ¿</span> ã‚’ãƒ‰ãƒ©ãƒƒã‚°</span>
          </div>
        </div>

        <div class="tableWrap">
          <table>
            <thead>
              <tr>
                <th style="width:70px;">drag</th>
                <th style="width:90px;">type</th>
                <th>from</th>
                <th style="width:90px;">flags</th>
                <th>to</th>
                <th style="width:120px;">æ“ä½œ</th>
              </tr>
            </thead>
            <tbody id="tbody"></tbody>
          </table>
        </div>

      </div>
    </div>

    <!-- ===== RIGHT: json ===== -->
    <div class="card">
      <div class="cardHead">
        <div style="font-weight:900;">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼JSON</div>
        <div style="flex:1"></div>
        <button id="copyBtn">ğŸ“‹ JSONã‚’ã‚³ãƒ”ãƒ¼</button>
      </div>
      <div class="cardBody">
        <div class="jsonArea">
          <textarea id="jsonOut" class="mono" spellcheck="false"></textarea>
          <div class="rightActions mini">
            <span>å³ã®JSONã¯å¸¸ã«æœ€æ–°</span>
          </div>
        </div>
      </div>
    </div>

  </div>

<script>
  const tbody = document.getElementById("tbody");
  const jsonOut = document.getElementById("jsonOut");
  const msg = document.getElementById("msg");

  const addType = document.getElementById("addType");
  const addFrom = document.getElementById("addFrom");
  const addFlags = document.getElementById("addFlags");
  const addTo = document.getElementById("addTo");
  const addPos = document.getElementById("addPos");
  const addDo = document.getElementById("addDo");

  let rows = [];
  let dragFromIndex = null;

  function defaultRow(){
    return { type:"text", from:"", flags:"g", to:"" };
  }

  function render(){
    tbody.innerHTML = "";
    rows.forEach((r, i) => {
      const tr = document.createElement("tr");
      tr.dataset.index = String(i);
      tr.draggable = true;

      tr.addEventListener("dragstart", (e)=>{
        dragFromIndex = i;
        tr.classList.add("dragging");
        e.dataTransfer.effectAllowed = "move";
      });
      tr.addEventListener("dragend", ()=>{
        dragFromIndex = null;
        tr.classList.remove("dragging");
        [...tbody.querySelectorAll("tr")].forEach(x=>x.classList.remove("dropTarget"));
      });
      tr.addEventListener("dragover", (e)=>{
        e.preventDefault();
        e.dataTransfer.dropEffect = "move";
        tr.classList.add("dropTarget");
      });
      tr.addEventListener("dragleave", ()=>{
        tr.classList.remove("dropTarget");
      });
      tr.addEventListener("drop", (e)=>{
        e.preventDefault();
        tr.classList.remove("dropTarget");
        const toIndex = Number(tr.dataset.index);
        if (dragFromIndex === null || dragFromIndex === toIndex) return;
        moveRow(dragFromIndex, toIndex);
      });

      const tdDrag = document.createElement("td");
      const handle = document.createElement("span");
      handle.className = "handle";
      handle.textContent = "â ¿";
      tdDrag.appendChild(handle);

      const tdType = document.createElement("td");
      const sel = document.createElement("select");
      ["text","word","regex"].forEach(t=>{
        const o=document.createElement("option"); o.value=t; o.textContent=t;
        if (r.type===t) o.selected=true;
        sel.appendChild(o);
      });
      sel.onchange = ()=>{ r.type = sel.value; syncJSON(); };
      tdType.appendChild(sel);

      const tdFrom = document.createElement("td");
      const inpFrom = document.createElement("input");
      inpFrom.style.width="100%";
      inpFrom.value = r.from || "";
      inpFrom.oninput = ()=>{ r.from = inpFrom.value; syncJSON(); };
      tdFrom.appendChild(inpFrom);

      const tdFlags = document.createElement("td");
      const inpFlags = document.createElement("input");
      inpFlags.style.width="70px";
      inpFlags.value = r.flags || "";
      inpFlags.placeholder = "g/gi";
      inpFlags.oninput = ()=>{ r.flags = inpFlags.value; syncJSON(); };
      tdFlags.appendChild(inpFlags);

      const tdTo = document.createElement("td");
      const inpTo = document.createElement("input");
      inpTo.style.width="100%";
      inpTo.value = r.to || "";
      inpTo.oninput = ()=>{ r.to = inpTo.value; syncJSON(); };
      tdTo.appendChild(inpTo);

      const tdOps = document.createElement("td");
      const del = document.createElement("button");
      del.textContent="ğŸ—‘";
      del.onclick=()=>{ rows.splice(i,1); render(); syncJSON(); };
      tdOps.appendChild(del);

      tr.append(tdDrag, tdType, tdFrom, tdFlags, tdTo, tdOps);
      tbody.appendChild(tr);
    });

    syncJSON();
  }

  function moveRow(from, to){
    const item = rows.splice(from, 1)[0];
    rows.splice(to, 0, item);
    render();
    syncJSON();
  }

  function compileCheck(entry){
    const t = entry.type;
    const from = entry.from ?? "";
    if (!from) return { ok:false, reason:"from ãŒç©ºã§ã™" };
    if (t === "text") return { ok:true };
    if (t === "word") {
      try { new RegExp("\\b" + escapeReg(from) + "\\b", "g"); return { ok:true }; }
      catch(e){ return { ok:false, reason:e.message }; }
    }
    if (t === "regex") {
      try { new RegExp(from, entry.flags || "g"); return { ok:true }; }
      catch(e){ return { ok:false, reason:e.message }; }
    }
    return { ok:false, reason:"typeä¸æ­£" };
  }

  function escapeReg(s){
    return String(s).replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
  }

  function syncJSON(){
    const out = rows.map(r => {
      const e = { type:r.type, from:r.from||"", to:r.to||"" };
      if (r.type === "regex") e.flags = (r.flags || "g");
      return e;
    });
    jsonOut.value = JSON.stringify(out, null, 2);
  }

  function validate(){
    const list = JSON.parse(jsonOut.value || "[]");
    let ok = true;
    let bad = 0;
    for (const e of list){
      const r = compileCheck(e);
      if (!r.ok){ ok=false; bad++; }
    }
    msg.textContent = ok ? `OK âœ…ï¼ˆ${list.length}ä»¶ï¼‰` : `NG âš ï¸ï¼ˆ${bad}ä»¶ã‚¨ãƒ©ãƒ¼ï¼‰`;
    msg.className = ok ? "mini ok" : "mini warn";
  }

  async function load(){
    msg.textContent = "èª­ã¿è¾¼ã¿ä¸­â€¦";
    msg.className = "mini";
    try{
      const res = await fetch("./dict/tts-dict.json?v=" + Date.now());
      if (!res.ok) throw new Error("fetch failed: " + res.status);
      const data = await res.json();
      rows = (Array.isArray(data) ? data : []).map(e => ({
        type: e.type || "text",
        from: e.from || "",
        flags: e.flags || "g",
        to: e.to || ""
      }));
      render();
      msg.textContent = `èª­ã¿è¾¼ã¿æˆåŠŸ âœ…ï¼ˆ${rows.length}ä»¶ï¼‰`;
      msg.className = "mini ok";
    }catch(e){
      console.warn(e);
      msg.textContent = "èª­ã¿è¾¼ã¿å¤±æ•—ï¼ˆdict/tts-dict.json ãŒç„¡ã„ or JSONå£Šã‚Œï¼‰";
      msg.className = "mini warn";
    }
  }

  function download(){
    const blob = new Blob([jsonOut.value], {type:"application/json"});
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "tts-dict.json";
    a.click();
    URL.revokeObjectURL(a.href);
  }

  async function copy(){
    try{
      await navigator.clipboard.writeText(jsonOut.value);
      msg.textContent = "ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ âœ…";
      msg.className = "mini ok";
    }catch(e){
      msg.textContent = "ã‚³ãƒ”ãƒ¼å¤±æ•—ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶åˆ¶é™ï¼‰";
      msg.className = "mini warn";
    }
  }

  function addRowAt(pos){
    const type = addType.value;
    const from = (addFrom.value || "").trim();
    const to = (addTo.value || "").trim();
    const flags = (addFlags.value || "g").trim();

    if (!from || !to){
      msg.textContent = "from / to ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„";
      msg.className = "mini warn";
      return;
    }

    const entry = { type, from, to, flags };

    // flagsã®æ‰±ã„ï¼ˆtext/wordã¯ä¸è¦ã ãŒä¿æŒã—ã¦ã‚‚å®³ã¯ãªã„ã€‚æ›¸ãå‡ºã—æ™‚ã«æ¶ˆã™ï¼‰
    let idx = rows.length;
    if (pos === "top") idx = 0;
    if (pos === "mid") idx = Math.floor(rows.length / 2);
    if (pos === "bottom") idx = rows.length;

    rows.splice(idx, 0, entry);
    render();
    syncJSON();

    // å…¥åŠ›æ¬„ã‚¯ãƒªã‚¢ï¼†æ¬¡ã®å…¥åŠ›ã«å³ç§»ã‚Œã‚‹
    addFrom.value = "";
    addTo.value = "";
    addFrom.focus();

    msg.textContent = `è¿½åŠ ã—ã¾ã—ãŸ âœ…ï¼ˆ${rows.length}ä»¶ï¼‰`;
    msg.className = "mini ok";
  }

  document.getElementById("loadBtn").onclick = load;
  document.getElementById("validateBtn").onclick = validate;
  document.getElementById("downloadBtn").onclick = download;
  document.getElementById("copyBtn").onclick = copy;

  addDo.onclick = ()=> addRowAt(addPos.value);
  addFrom.addEventListener("keydown", (e)=>{ if(e.key==="Enter"){ addRowAt(addPos.value); } });
  addTo.addEventListener("keydown", (e)=>{ if(e.key==="Enter"){ addRowAt(addPos.value); } });

  // åˆæœŸ1è¡Œ
  rows = [defaultRow()];
  render();
</script>
</body>
</html>

<script>
  const tbody = document.getElementById("tbody");
  const jsonOut = document.getElementById("jsonOut");
  const msg = document.getElementById("msg");

  let rows = [];

  function defaultRow(){
    return { type:"text", from:"", flags:"g", to:"" };
  }

  function render(){
    tbody.innerHTML = "";
    rows.forEach((r, i) => {
      const tr = document.createElement("tr");

      const tdType = document.createElement("td");
      const sel = document.createElement("select");
      ["text","word","regex"].forEach(t=>{
        const o=document.createElement("option"); o.value=t; o.textContent=t;
        if (r.type===t) o.selected=true;
        sel.appendChild(o);
      });
      sel.onchange = ()=>{ r.type = sel.value; syncJSON(); };
      tdType.appendChild(sel);

      const tdFrom = document.createElement("td");
      const inpFrom = document.createElement("input");
      inpFrom.style.width="100%";
      inpFrom.value = r.from || "";
      inpFrom.oninput = ()=>{ r.from = inpFrom.value; syncJSON(); };
      tdFrom.appendChild(inpFrom);

      const tdFlags = document.createElement("td");
      const inpFlags = document.createElement("input");
      inpFlags.style.width="70px";
      inpFlags.value = r.flags || "";
      inpFlags.placeholder = "g/gi";
      inpFlags.oninput = ()=>{ r.flags = inpFlags.value; syncJSON(); };
      tdFlags.appendChild(inpFlags);

      const tdTo = document.createElement("td");
      const inpTo = document.createElement("input");
      inpTo.style.width="100%";
      inpTo.value = r.to || "";
      inpTo.oninput = ()=>{ r.to = inpTo.value; syncJSON(); };
      tdTo.appendChild(inpTo);

      const tdOps = document.createElement("td");
      const up = document.createElement("button");
      up.textContent="â†‘";
      up.onclick=()=>{ if(i>0){ [rows[i-1],rows[i]]=[rows[i],rows[i-1]]; render(); syncJSON(); } };
      const down = document.createElement("button");
      down.textContent="â†“";
      down.onclick=()=>{ if(i<rows.length-1){ [rows[i+1],rows[i]]=[rows[i],rows[i+1]]; render(); syncJSON(); } };
      const del = document.createElement("button");
      del.textContent="ğŸ—‘";
      del.onclick=()=>{ rows.splice(i,1); render(); syncJSON(); };
      tdOps.append(up, down, del);

      tr.append(tdType, tdFrom, tdFlags, tdTo, tdOps);
      tbody.appendChild(tr);
    });

    syncJSON();
  }

  function compileCheck(entry){
    const t = entry.type;
    const from = entry.from ?? "";
    if (!from) return { ok:false, reason:"from ãŒç©ºã§ã™" };
    if (t === "text") return { ok:true };
    if (t === "word") {
      // word ã¯å†…éƒ¨ã§ \bfrom\b ã«ã™ã‚‹æƒ³å®šï¼ˆè‹±æ•°å­—å‘ã‘ï¼‰
      try { new RegExp("\\b" + escapeReg(from) + "\\b", "g"); return { ok:true }; } catch(e){ return { ok:false, reason:e.message }; }
    }
    if (t === "regex") {
      try { new RegExp(from, entry.flags || "g"); return { ok:true }; } catch(e){ return { ok:false, reason:e.message }; }
    }
    return { ok:false, reason:"typeä¸æ­£" };
  }

  function escapeReg(s){
    return String(s).replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
  }

  function syncJSON(){
    // ä¸è¦ãªflagsã‚’æ•´ç†
    const out = rows.map(r => {
      const e = { type:r.type, from:r.from||"", to:r.to||"" };
      if (r.type === "regex") e.flags = (r.flags || "g");
      if (r.type === "text") { /* flagsä¸è¦ */ }
      if (r.type === "word") { /* flagsä¸è¦ï¼ˆå†…éƒ¨ã§gå›ºå®šï¼‰ */ }
      return e;
    });
    jsonOut.value = JSON.stringify(out, null, 2);
  }

  function validate(){
    const list = JSON.parse(jsonOut.value || "[]");
    let ok = true;
    let bad = 0;
    for (const e of list){
      const r = compileCheck(e);
      if (!r.ok){ ok=false; bad++; }
    }
    msg.textContent = ok ? `OK âœ…ï¼ˆ${list.length}ä»¶ï¼‰` : `NG âš ï¸ï¼ˆ${bad}ä»¶ã‚¨ãƒ©ãƒ¼ï¼‰`;
    msg.className = ok ? "mini ok" : "mini warn";
  }

  async function load(){
    msg.textContent = "èª­ã¿è¾¼ã¿ä¸­â€¦";
    msg.className = "mini";
    try{
      const res = await fetch("./dict/tts-dict.json?v=" + Date.now());
      if (!res.ok) throw new Error("fetch failed: " + res.status);
      const data = await res.json();
      rows = (Array.isArray(data) ? data : []).map(e => ({
        type: e.type || "text",
        from: e.from || "",
        flags: e.flags || "g",
        to: e.to || ""
      }));
      render();
      msg.textContent = `èª­ã¿è¾¼ã¿æˆåŠŸ âœ…ï¼ˆ${rows.length}ä»¶ï¼‰`;
      msg.className = "mini ok";
    }catch(e){
      console.warn(e);
      msg.textContent = "èª­ã¿è¾¼ã¿å¤±æ•—ï¼ˆdict/tts-dict.json ãŒç„¡ã„ or JSONå£Šã‚Œï¼‰";
      msg.className = "mini warn";
    }
  }

  function download(){
    const blob = new Blob([jsonOut.value], {type:"application/json"});
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "tts-dict.json";
    a.click();
    URL.revokeObjectURL(a.href);
  }

  async function copy(){
    try{
      await navigator.clipboard.writeText(jsonOut.value);
      msg.textContent = "ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ âœ…";
      msg.className = "mini ok";
    }catch(e){
      msg.textContent = "ã‚³ãƒ”ãƒ¼å¤±æ•—ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶åˆ¶é™ï¼‰";
      msg.className = "mini warn";
    }
  }

  document.getElementById("loadBtn").onclick = load;
  document.getElementById("addBtn").onclick = ()=>{ rows.push(defaultRow()); render(); };
  document.getElementById("validateBtn").onclick = validate;
  document.getElementById("downloadBtn").onclick = download;
  document.getElementById("copyBtn").onclick = copy;

  // åˆæœŸ1è¡Œ
  rows = [defaultRow()];
  render();
</script>
</body>
</html>
